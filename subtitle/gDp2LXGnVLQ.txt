好 大家好 那我們就開始上課吧
好那今天這堂課呢
我們要跟大家講的是Anomaly Detection
如果翻譯成中文的話呢
我們可以說是要翻譯異常偵測
那異常偵測要做的是什麼呢?
異常偵測就是如同我們上一次
上課的時候跟同學說的
我們要讓機器可以知道
我不知道這件事情
好 那右邊呢
就是引用了論語的為政篇
論語對子路說 這個子路啊
知之為知之 不知為不知是知也
就是說知道就是知道
不知道就說不知道
這樣才是真正的知道
那我們就是要讓機器呢
來知道他不知道這件事情
好 那這個異常偵測呢
他的問題啊
通常formulate成下面這個樣子
就我們現在呢 有一堆訓練的資料
訓練的資料呢
我們用x¹到xⁿ來表示訓練的資料
那在這門課裡面呢
我們通常用上標
來表示一個完整的東西
用下標呢
來表示一個完整東西的其中一個部份
現在這樣講可能還有點抽象
等一下你會更清楚
我想表示的意思是什麼
總之我們現在呢 有N個訓練資料
那我們呢 現在有N個訓練資料
我們要找出一個function
這個function做的事情是
當它看到一個input x的時候
它要決定說 現在這個input x
到底跟我們這個訓練資料的
這些data算是相像的
算是相像的可以被歸在同類
還是不像
那我們之前有說過說
Machine learning其實就是要機器找一個function
在異常偵測裡面
我們要找的是什麼樣的function呢?
我們要找的function是這樣的
如果我們今天給它一個x
這個x像是我們提供給機器的
那些訓練資料
那我們這個異常偵測的function
這個anomaly detector就會說這是正常的資料
那如果現在input的x它不像是我們
訓練資料理面的那些data
不像是我們訓練資料裡面的
那些x¹到xⁿ的話
那這個anomaly detector
就要說這是一個異常的東西
這是一個anomaly
那因為我們這邊呢
是用anomaly這一個詞彙
可能會讓有些同學覺得說
機器在做anomaly detection的時候
它都是要detect出不好的東西
因為異常這個詞彙顯然通常代表的是
一個負面的意思
但是其實anomaly detection這件事情
並不一定是找不好的東西
它只是找跟訓練資料不一樣的東西
所以我們找出來的東西
不見得是異常的東西
那其實你會發現說anomaly detection這個技術
在不同的領域裡面
其實它有不同的名字
有時候我們叫它outlier detection
有時候我們叫它novelty detection
如果你是用novelty這個詞彙
顯然是要找一個新的東西
Novelty就比較是一個正面的意思
或者是說叫做exception 的detection
總之我們要找的就是和訓練資料
不一樣的東西
那它有可能是特別好的
也有可能是特別壞的
但至於什麼叫做像呢
什麼叫做像訓練資料呢
這就是anomaly detection裡面需要探討的問題
不同的方法
它就用不同的方式來定義說
什麼叫像 什麼叫做不像
好那這個呢是異常偵測的problem的formulation
好那這個要強調一下 什麼叫做異常呢
這個所謂的異常
我們到底要檢測出什麼東西
我們到底要機器看到什麼東西說它是anomaly
其實是取決於你提供給機器
什麼樣的訓練資料
舉例來說 假如你的訓練資料
你給它看很多隻雷丘
那這個時候呢 皮卡丘就是異常
那反過來說
如果你給他看很多隻皮卡丘
那雷丘就是異常的
或者是如果你給他看很多的寶可夢
有皮卡丘 雷丘 還有水劍龜
那這個時候呢 數碼寶貝就是異常的
或者不是寶可夢的東西就是異常的
那個不知道的同學講一下
這個叫做數碼寶貝啦
它跟寶可夢 也就是神奇寶貝很像啦
這一隻其實是亞古獸
它看起來很像是噴火龍但其實不是
好那這個異常偵測呢
有非常多的應用
舉例來說
今天你可以拿它來做詐欺偵測
做fraud detection
那你的訓練資料呢
可能就是正常的刷卡行為
蒐集很多很多的交易紀錄
銀行其實都有在做這件事
就蒐集很多很多的交易紀錄
那這些交易紀錄呢
視為正常的交易行為
那今天有一筆新的交易紀錄
就可以用異常檢測的技術來看說
這筆交易紀錄到底是不是
有詐欺的嫌疑
它是不是盜刷了別人的卡
那可能正常的交易它的金額都比較小
頻率都比較低
那如果今天有一個非常高額的消費
又在短時間內連續非常高額的消費
他可能就是一個異常的行為
那這個都還是有現成的資料庫跟比賽的喔
就在下面列了兩個kaggle的連結
那這個它也可以拿來做這個
網路系統的入侵偵測
那你的訓練資料呢就是正常的連線
那今天有一筆新的連線進來
那你希望用anomaly detection這個技術
讓機器自動決定說呢 這筆資料
它是一個攻擊的行為
還是不是攻擊的行為
那或者是呢 它也可以被用在醫療上
舉例來說 癌細胞的偵測
你的訓練資料就是正常的細胞
正常細胞它長什麼樣子
它的細胞核的大小
它的分裂的頻率等等
你有正常的細胞的資料
你的訓練資料是正常的細胞
那今天呢
給一個新的細胞機器可以自動決定說
它是有問題的癌細胞還是正常的細胞
所以 這個異常偵測呢
它有非常多有用的應用
好 那再來的問題就是
我們怎麼做異常偵測這件事情呢
可以用很直覺的想法就是
我們現在如果可以蒐集到
很多正常的資料
這邊寫說x¹到xⁿ
我們可以蒐集到很多異常的資料
這邊寫做x̃¹到x̃ⁿ
那我們其實都已經學過
怎麼做binary classifier這件事
那在今天上課前
你應該看我們的錄影裡面
已經講過了binary classification
所以假設大家都知道
binary classification是什麼的
那我們可以把normal的data當做一個class
它是class 1
把那些異常的data
當做是另外一個class class 2
舉例來說 在剛才詐欺偵測裡面
正常的交易就是class 1
異常的交易 有詐欺嫌疑的交易
它就是class 2
這個時候你已經學過了binary classification的技術
你就只需要訓練一個binary的classifier
然後呢就讓機器學把data分成兩類
一類是正常的 一類是異常的
然後 就沒有然後了
就結束了 這個都是你會的東西
所以我想我們今天上課
其實差不多就上到這邊
就請助教來講一下作業二這樣子
但是其實呢 這個問題並沒有那麼簡單
為什麼這麼說呢
你其實不太容易把這個異常偵測
視為一個普通的binary classification的問題
為什麼這樣說呢
假設你現在所謂正常的data
是寶可夢 寶可夢是正常的data
那異常的data到底是什麼呢
只要不是寶可夢的東西
都可以是異常的data
不只是數碼寶貝是異常的data
涼宮春日也是異常的data
或者甚至說 隨便拿一個茶壺
也是異常的data
世界上可以舉不是寶可夢的
例子太多了
我也不知道為什麼要特別舉一個茶壺
舉這個例子的時候 我實在是想很久
因為不是寶可夢的實在太多了
我不知道要舉什麼
不知道為什麼就舉了一個茶壺
反正不是寶可夢的東西太多了
基本上多數的東西都不是寶可夢
所以首先你根本無法窮舉所有
不是寶可夢的東西
你根本沒有辦法知道你整個class 2
整個異常的資料的分佈
到底應該長什麼樣
你根本不應該把異常的資料
視為一個類別
因為它的變化太大了
你根本沒有辦法把這個類別裡面
所有的資料都蒐集齊
知道所有不是寶可夢的東西
所有的class 2所有的異常資料
長什麼樣子
這是第一個你不能夠把
這個異常偵測當做二元分類的原因
第二個原因是
很多情況下 你其實
不太容易蒐集到異常的資料
蒐集正常的資料往往比較容易
而蒐集異常的資料
往往比較困難
舉例來說 剛才詐欺偵測的例子而言
你可以想像說 多數的交易
通常都是正常的
你很難找到異常的交易
有多數 今天銀行可以蒐集到的資料
都是正常的交易
就算它是一個異常的交易
還會告訴你說 它是一個正常的交易
所以你很難蒐集到anomaly異常的data
這就造成這個異常偵測這個問題
它不是一個單純的二元分類的問題
你需要想其他的方法
它是一個獨立的研究主題
這是一個仍然尚待研究的問題
好那這邊呢
我們對異常偵測問題做一個
非常簡單的分類
那我們先把它分成兩類
一類是
現在我們除了不只有這些訓練資料
x¹到xⁿ同時這些訓練資料
它是有某種類型的label的
那等一下我們會有更具體的例子
告訴大家說 有什麼樣的label
所以現在每一個x¹到xⁿ
它都有label標註說 它是ŷ¹到ŷⁿ
所以有這些label
你就可以拿來訓練一個classifier
教機器說 看到這些x
要怎麼 能不能夠預測出
它對應的ŷ是什麼
那訓練一個classifier怎麼做呢
其實我們在上課錄音裡面都有講過了
你就可以用
我們上課有講過說 用generative model來做classification
也說過用logistic regression來做classification
那還講過用Bitnami來做classification
就可以選一個你喜歡的技術
來訓練一個classifier
但是在這邊的label裡面
並沒有任何一種label叫做unknown
並沒有任何一種label叫做
這是我不知道的東西
這是一個未知物
但我們期待說 我們訓練好一個classifier以後
機器有能力知道
如果他看到一個X不在它的
訓練資料裡面的
這個時候它應該給這個
它沒有看過的東西貼上標籤說
這個沒看過的東西 它是unknown的
這個沒看過的東西 它的類別
是屬於unknown的
那如果你是說 你有一個classifier
你希望這個classifier具有
看到不知道的東西 它會標上
這是未知物的能力的話
那這個問題 它是異常偵測其中一種
那它又叫做open set recognition
就是你現在在做辨識的時候
你現在在做分類的時候
你的model是open的
它可以辨識它沒有看過的東西
沒有看過的東西 它就貼上一個標籤說
這是沒有看過的
那另外一方面呢
有時候你會遇到的狀況是
你這些訓練資料 它是沒有任何label
它就是一堆資料進來
它沒有其他額外的label
這個時候你只能在
只有這些資料的情況下
想辦法去判斷說
今天新的一筆資料 它跟這些資料
像 還是不像
那這邊我又分成兩個case
一個case是 你手上的資料是乾淨的
所謂乾淨的意思是說
你手上所有的訓練資料
通通都是正常的資料
但你更常見的一個狀況是
你手上的資料就已經有被污染過了
已經有被污染過的意思是說
你手上這些資料裡面
混雜了一些其實是異常的東西
舉例來說 我們剛才舉
詐欺偵測這個例子
銀行蒐集了大量的訓練資料
蒐集了大量的交易紀錄
它把所有的交易紀錄都當作正常的
去告訴機器說 什麼叫做正常的交易
希望機器可以藉此偵測出異常的交易
但那些正常的交易裡面
很有可能也混雜了異常的交易
很有可能也混雜了詐欺的行為
只是銀行在蒐集資料的時候
不知道這件事
所以更多的時候 我們遇到的狀況是
我們手上有訓練資料
但我們沒有辦法保證
所有的訓練資料都是正常的
可能有非常少量的訓練資料 比如說
1%的訓練資料 0.1%的訓練資料
它其實仍然是異常的
好那等一下呢 我們就是有label的
跟沒有label的case 各舉一個例子
我們先來講
